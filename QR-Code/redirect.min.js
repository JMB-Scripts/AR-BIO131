window.onload = function() {
  const urlParams = new URLSearchParams(window.location.search);
  const userAgent = navigator.userAgent.toLowerCase();

  const redirectTo = (url) => {
    if (url) {
      window.location.href = url;
    } else {
      document.body.innerHTML = 'Unsupported device';
    }
  };

  if (/iphone|ipad/.test(userAgent)) {
    redirectTo(urlParams.get('ios'));
  } else if (/android/.test(userAgent)) {
    const modelViewer = document.createElement('model-viewer');
    modelViewer.src = urlParams.get('android');
    modelViewer.ar = true;
    modelViewer.setAttribute('ar-modes', 'webxr scene-viewer quick-look');
    modelViewer.environmentImage = 'neutral';
    modelViewer.autoRotate = true;
    modelViewer.cameraControls = true;
    document.body.appendChild(modelViewer);
  } else {
    redirectTo();
  }
};